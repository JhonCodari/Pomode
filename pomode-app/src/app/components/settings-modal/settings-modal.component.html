<div class="modal-overlay" (click)="cancel()" role="dialog" aria-modal="true" aria-labelledby="settings-title">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <app-card [elevated]="true" [hasHeader]="true">
      <div card-header>
        <h3 id="settings-title"><span aria-hidden="true">âš™ï¸</span> ConfiguraÃ§Ãµes</h3>
      </div>

      <div class="settings-form">
        <!-- SeÃ§Ã£o: Tempos -->
        <div class="settings-section">
          <h4 class="section-title">Tempos</h4>

          <!-- Tempo de Foco -->
          <div class="form-group">
            <label for="workTime">
              <span aria-hidden="true">ğŸ…</span> Tempo de Foco (minutos)
            </label>
            <input
              id="workTime"
              type="number"
              [(ngModel)]="workTime"
              [min]="limits.workTime.min"
              [max]="limits.workTime.max"
              class="form-input"
              aria-describedby="workTime-hint"
            />
            <span id="workTime-hint" class="form-hint">
              Entre {{ limits.workTime.min }} e {{ limits.workTime.max }} minutos
            </span>
          </div>

          <!-- Pausa Curta -->
          <div class="form-group">
            <label for="shortBreak">
              <span aria-hidden="true">â˜•</span> Pausa Curta (minutos)
            </label>
            <input
              id="shortBreak"
              type="number"
              [(ngModel)]="shortBreakTime"
              [min]="limits.shortBreakTime.min"
              [max]="limits.shortBreakTime.max"
              class="form-input"
              aria-describedby="shortBreak-hint"
            />
            <span id="shortBreak-hint" class="form-hint">
              Entre {{ limits.shortBreakTime.min }} e {{ limits.shortBreakTime.max }} minutos
            </span>
          </div>

          <!-- Pausa Longa -->
          <div class="form-group">
            <label for="longBreak">
              <span aria-hidden="true">ğŸŒ´</span> Pausa Longa (minutos)
            </label>
            <input
              id="longBreak"
              type="number"
              [(ngModel)]="longBreakTime"
              [min]="limits.longBreakTime.min"
              [max]="limits.longBreakTime.max"
              class="form-input"
              aria-describedby="longBreak-hint"
            />
            <span id="longBreak-hint" class="form-hint">
              Entre {{ limits.longBreakTime.min }} e {{ limits.longBreakTime.max }} minutos
            </span>
          </div>

          <!-- Ciclos -->
          <div class="form-group">
            <label for="cycles">
              <span aria-hidden="true">ğŸ”„</span> Ciclos antes da pausa longa
            </label>
            <input
              id="cycles"
              type="number"
              [(ngModel)]="cyclesBeforeLongBreak"
              [min]="limits.cyclesBeforeLongBreak.min"
              [max]="limits.cyclesBeforeLongBreak.max"
              class="form-input"
              aria-describedby="cycles-hint"
            />
            <span id="cycles-hint" class="form-hint">
              Entre {{ limits.cyclesBeforeLongBreak.min }} e {{ limits.cyclesBeforeLongBreak.max }} ciclos
            </span>
          </div>
        </div>

        <!-- SeÃ§Ã£o: Som -->
        <div class="settings-section">
          <h4 class="section-title">Som</h4>

          <!-- Toggle de Som -->
          <div class="form-group form-group-toggle">
            <label for="soundEnabled">
              <span aria-hidden="true">ğŸ”Š</span> Som de alerta
            </label>
            <label class="toggle-switch">
              <input
                id="soundEnabled"
                type="checkbox"
                [(ngModel)]="soundEnabled"
              />
              <span class="toggle-slider"></span>
            </label>
          </div>

          <!-- Volume -->
          @if (soundEnabled()) {
            <div class="form-group">
              <label for="soundVolume">
                <span aria-hidden="true">ğŸšï¸</span> Volume ({{ soundVolume() }}%)
              </label>
              <div class="volume-control">
                <input
                  id="soundVolume"
                  type="range"
                  [(ngModel)]="soundVolume"
                  [min]="limits.soundVolume.min"
                  [max]="limits.soundVolume.max"
                  class="form-range"
                />
                <app-button
                  [variant]="'ghost'"
                  [size]="'sm'"
                  (click)="testSound()"
                  title="Testar som"
                >
                  <span aria-hidden="true">â–¶</span> Testar
                </app-button>
              </div>
            </div>
          }
        </div>

        <!-- SeÃ§Ã£o: NotificaÃ§Ãµes -->
        <div class="settings-section">
          <h4 class="section-title">NotificaÃ§Ãµes</h4>

          <!-- Toggle de NotificaÃ§Ãµes -->
          <div class="form-group form-group-toggle">
            <label for="notificationsEnabled">
              <span aria-hidden="true">ğŸ””</span> NotificaÃ§Ãµes do navegador
            </label>
            <label class="toggle-switch">
              <input
                id="notificationsEnabled"
                type="checkbox"
                [(ngModel)]="notificationsEnabled"
                (change)="notificationsEnabled() && requestNotificationPermission()"
              />
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>

      <div class="modal-actions">
        <app-button
          [variant]="'ghost'"
          [size]="'md'"
          (click)="resetToDefault()"
        >
          PadrÃ£o
        </app-button>

        <div class="action-buttons">
          <app-button
            [variant]="'outline'"
            [size]="'md'"
            (click)="cancel()"
          >
            Cancelar
          </app-button>

          <app-button
            [variant]="'primary'"
            [size]="'md'"
            (click)="saveSettings()"
          >
            Salvar
          </app-button>
        </div>
      </div>
    </app-card>
  </div>
</div>
